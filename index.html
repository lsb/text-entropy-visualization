<!doctype HTML>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta charset="UTF-8">
<script src="d3.v2.js"></script>
<script src="text-entropy.js"></script>
<script>
window.onload = function() {
    "use strict";
    var word_id_mapping = TextEntropy.word_id_mapping;
    var xhrFetchK = word_id_mapping.xhrFetchK;
    var loadWords = word_id_mapping.loadWords;
    var longLine = 12;
    var shortLine = 6;
    var smallX = 80;
    var smallY = 80;
    var largeX = 160;
    var largeY = 160;
    var orders = [5,4,3];

    xhrFetchK(true, function(words) {
	    loadWords(words);
	    xhrFetchK(false, loadWords);
	    TextEntropy.utils.eachk(orders, function(order,i,k) {
		    TextEntropy.dataVisualizations.renderSentence(TextEntropy.utils.smallerTestSentence, order, smallX, smallY, longLine, d3.select("#shannon" + order));
		    setTimeout(k,0); // so that we show progress as each renders
		}, function() {});
	});
    document.getElementById("sentence").value = TextEntropy.utils.testSentence;
    document.getElementById("render").onsubmit = function() {
	TextEntropy.dataVisualizations.renderSentence(document.getElementById("sentence").value, document.getElementById("order").value, largeX, largeY, shortLine, d3.select("#wrapper"));
	return false;
    };
};
</script>
<style>
body {
  font: 12pt Georgia;
  width: 10in;
  margin: auto;
}
.axis path, .axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
path.layer:hover {
  fill: white !important;
}
text.helptext {
  fill: black;
  text-shadow: 2px 2px 4px white;
  font-size: 14pt;
}
#armstrong-triptych svg {
  margin: 0.1in;
}
text.passage-word {
  text-anchor: end;
  font-size: 12pt;
  text-shadow: 0px 0px 8px white;
}
#render #sentence {
  width: 100%;
  height: 1in;
}
#tooltip {
  position: absolute;
}
</style>
</head>
<body>
<h1>Text Entropy Visualization</h1>

<h2>This is a visualization of the total information conveyed by an arbitrary message.</h2>

<p>How much information do you get from a message? That depends on your model of what you're reading. If it's in English, you can even skip the last word in a sentence but still grasp the gist of __. If it's in a foreign language, you might get a lot more information about content, grammar, orthography, alphabet.</p>

<p>It would be interesting to take a few language models of modern English, and to use them to visualize the total information conveyed by an arbitrary message.</p>

<p>I decided to use five word-based Markov models of modern format English, zeroth-order to fourth-order, from printed text from 1800-2008, via the Google Books n-gram dataset. Each word in a passage is represented by a stack of colored bars, stacked in a square block; each bar represents a word in context that the model predicted; the vertical percentage of each bar starts as its probability predicted by the model, and the percentage tweens to either 0% or 100% depending on whether that word was the actual word in context. The color of the actual word is faded, whereas the colors of all the other words are vivid: a vivid image represent a more information-rich, less predictable message.</p>

<p>Note how the 5-gram model predicts each word better, and thus makes a much more faded image, than a 4-gram model, and similarly the 4-gram model is more predictive than the 3-gram model.</p>

<div id="armstrong-triptych">
<svg id="shannon5" xmlns="http://www.w3.org/2000/svg"></svg>
<svg id="shannon4" xmlns="http://www.w3.org/2000/svg"></svg>
<svg id="shannon3" xmlns="http://www.w3.org/2000/svg"></svg>
</div>

<p>Try it out yourself!</p>

<form id="render">
<div>
<textarea id="sentence">
</textarea>
</div>
<select id="order">
<option value="5">5-gram</option>
<option value="4">4-gram</option>
<option value="3">3-gram (might be slow)</option>
</select>
<input type="submit" value="Render">
</form>

<svg id="wrapper" xmlns="http://www.w3.org/2000/svg" height="1in"></svg>

<div id="tooltip"></div>

<p>&copy; 2012 <a href="http://www.leebutterman.com">Lee Butterman</a>. Code available on GitHub for <a href="http://github.com/lsb/text-entropy">creating the statistical model</a>, <a href="https://github.com/lsb/text-entropy-api">the web service to pull stats on words</a>, and <a href="https://github.com/lsb/text-entropy-visualization">this data visualization</a>.
</body>
</html>
